{"version":3,"sources":["FuryLazyCall.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FuryLazyCall.js","sourcesContent":["(function() {\n  'use strict';\n\n  function CallMethod(object, name, fn) {\n    this.object = object;\n    this.name = name;\n    this.fn = object[name];\n  }\n  CallMethod.prototype.exec = function(args) {\n    this.fn.apply(this.object, args);\n  };\n  CallMethod.prototype.replaceWith = function(newFn) {\n    this.object[this.name] = newFn;\n  };\n  CallMethod.prototype.revert = function() {\n    this.object[this.name] = this.fn;\n  };\n  CallMethod.prototype.equals = function(method) {\n    return this.object === method.object && this.name === method.name;\n  };\n\n  function CallObject(method, args) {\n    this.method = method;\n    this.arguments = Array.prototype.slice.call(args);\n  }\n  CallObject.prototype.exec = function() {\n    this.method.exec(this.arguments);\n  };\n\n  /**\n   * [FuryLazyCall]\n   */\n  function FuryLazyCall() {\n    this._isLoaded = false;\n    this._methods = [];\n    this._callQueue = [];\n  }\n\n  /**\n   * [exec]\n   */\n  FuryLazyCall.prototype.exec = function() {\n    this._isLoaded = true;\n    this._revertAllMethods();\n    this._makeCalls();\n  };\n\n  /**\n   * [last]\n   */\n  FuryLazyCall.prototype.last = function(object, methodName) {\n    if (this._isLoaded) {\n      // do nothing\n      return;\n    }\n\n    var _this = this,\n        method = new CallMethod(object, methodName);\n\n    method.replaceWith(function() {\n      var callObject = _this._getCallObject(method);\n      if(callObject) {\n        // replace call args\n        callObject.arguments = arguments;\n      }\n      else {\n        // create new call\n        var methodCall = new CallObject(method, arguments);\n\n        _this._callQueue.push(methodCall);\n      }\n    });\n\n    this._methods.push(method);\n  };\n\n  FuryLazyCall.prototype._getCallObject = function(method) {\n    for(var i in this._callQueue) {\n      var callObject = this._callQueue[i];\n      if(method.equals(callObject.method)) {\n        return callObject;\n      }\n    }\n    return false;\n  };\n  FuryLazyCall.prototype._makeCalls = function() {\n    this._callQueue.forEach(function(callObject) {\n      callObject.exec();\n    });\n    this._callQueue = [];\n  };\n  FuryLazyCall.prototype._revertAllMethods = function() {\n    this._methods.forEach(function(method) {\n      method.revert();\n    });\n    this._methods = [];\n  };\n\n  if(typeof exports !== 'undefined') {\n    exports = FuryLazyCall;\n  }\n  else {\n    window.FuryLazyCall = FuryLazyCall;\n  }\n\n})();"],"sourceRoot":"/source/"}